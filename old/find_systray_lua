get_systray_geometry() {

awesome-client '
local awful = require("awful")
local s
local found_widget_geometry

awful.screen.connect_for_each_screen(function(screen)
    if screen.systray.visible == true then s = screen end
end)

local function find_widget_in_wibox(wb, wdg)
    
    local function get_geometry(hi)
                local x, y, w, h = gears.matrix.transform_rectangle(hi:get_matrix_to_device(), 0, 0, hi:get_size())
                local x = math.floor(x) ; local y = math.floor(y)
                local w = math.floor(w) ; local h = math.floor(h)
                found_widget_geometry = x .. "," .. y .. "," .. w .. "," .. h
    end

    local function traverse(hi)
        if hi:get_widget() == wdg then
            get_geometry(hi)
            return
        end
        for _, child in ipairs(hi:get_children()) do
         -- return traverse(child) -- Others have this line, but for us it returned only container widgets.
            traverse(child) -- Removing "return" allows for an additional round of recursion, tested on v4.3
        end
    end
    return traverse(wb._drawable._widget_hierarchy)
end

if s == nil then return nil end
find_widget_in_wibox(s.mywibox, s.systray)
return found_widget_geometry
'
}
